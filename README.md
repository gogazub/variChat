# veriChat

**veriChat** ‚Äî —ç—Ç–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞ Go –¥–ª—è –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã—Ö —á–∞—Ç–æ–≤.  
–û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫—ç—à–∏—Ä—É–µ—Ç –∏—Ö, –∞ –∑–∞—Ç–µ–º —Å—Ç—Ä–æ–∏—Ç **Merkle Tree** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.  
–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç.

---

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ clib
‚îÇ   ‚îú‚îÄ‚îÄ CMakeLists.txt
‚îÇ   ‚îú‚îÄ‚îÄ engine.cpp    
‚îÇ   ‚îú‚îÄ‚îÄ engine.h
‚îÇ   ‚îî‚îÄ‚îÄ libengine.so  
‚îú‚îÄ‚îÄ docker-compose.yaml       # –ø–æ–¥–Ω–∏–º–∞–µ—Ç MySQL –∏ Redis
‚îú‚îÄ‚îÄ go
‚îÇ   ‚îú‚îÄ‚îÄ cmd/api/main.go
‚îÇ   ‚îî‚îÄ‚îÄ internal
‚îÇ       ‚îú‚îÄ‚îÄ api/       
‚îÇ       ‚îú‚îÄ‚îÄ cgobridge/        # Go <-> C++ –º–æ—Å—Ç
‚îÇ       ‚îú‚îÄ‚îÄ db/               # —Ä–∞–±–æ—Ç–∞ —Å MySQL –∏ Redis
‚îÇ       ‚îî‚îÄ‚îÄ service/   
‚îú‚îÄ‚îÄ init.sql                  # –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã MySQL
‚îú‚îÄ‚îÄ run.sh                    # —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ test.sh                   # —Ç–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ README.md
```

---

## ‚öôÔ∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **Go (net/http)** - –æ—Å–Ω–æ–≤–Ω–æ–π HTTP-—Å–µ—Ä–≤–µ—Ä –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞  
- **C++ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç openssl)** - —Ç—è–∂–µ–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è Merkle Root  
- **Redis** - –∫—ç—à, –æ—á–µ—Ä–µ–¥—å –±–∞—Ç—á–µ–π –∏ idempotency  
- **MySQL** - –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –±–∞—Ç—á–µ–π  
- **CGO Bridge** - —Å–≤—è–∑—ã–≤–∞–µ—Ç Go –∏ C++ (—á–µ—Ä–µ–∑ `cgobridge` –ø–∞–∫–µ—Ç)

---

## üöÄ –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –°–æ–±–µ—Ä–∏ C++ –±–∏–±–ª–∏–æ—Ç–µ–∫—É:
   ```bash
   cd clib
   mkdir -p build && cd build
   cmake ..
   cmake --build .
   ```

2. –ü–æ–¥–Ω–∏–º–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:
   ```bash
   docker compose up -d
   ```

3. –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä:
   ```bash
   ./run.sh
   ```

–°–∫—Ä–∏–ø—Ç `run.sh` —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø—É—Ç–∏ –¥–ª—è CGO –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç Go-—Å–µ—Ä–≤–µ—Ä.  
–ü–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç HTTP –Ω–∞ `localhost:8080` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).

---

## üåê API

### POST `/messages`
_–û–ø–∏—Å–∞–Ω–∏–µ, –ø—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ—Ç–≤–µ—Ç–∞  –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ._

### POST `/merkle`
_–û–ø–∏—Å–∞–Ω–∏–µ, –ø—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ—Ç–≤–µ—Ç–∞  –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ._

---

## üß† –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **C++ –±–∏–Ω–¥–∏–Ω–≥** –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è Merkle Tree - –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ —Ç—è–∂–µ–ª–∞—è —á–∞—Å—Ç—å –≤—ã–Ω–µ—Å–µ–Ω–∞ –∏–∑ Go.  
- **MySQL** —Ö—Ä–∞–Ω–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (source of truth).  
- **Redis** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è, –æ—á–µ—Ä–µ–¥–µ–π –±–∞—Ç—á–µ–π –∏ –∑–∞—â–∏—Ç—ã –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è.  
- –ë–∞—Ç—á–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π **flush** –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–æ—Ä–Ω—è Merkle.  
- –ü—Ä–æ—Å—Ç–∞—è, –Ω–æ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫—É.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏ —Ç–æ–ª—å–∫–æ –ø–∞–∫–µ—Ç `cgobridge`.  
–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏ unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤, API –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

---

## TODO


–ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è:

0. –í—ã–Ω–µ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ .env
1. –†–∞—Å—à–∏—Ä–∏—Ç—å API. (+ swagger) 
2. –ü–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–∞–º–∏ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (db, service, api).  
3. –ó–∞–º–µ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.  
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä –∏ –¥–æ–±–∞–≤–∏—Ç—å CI-–ø—Ä–æ–≤–µ—Ä–∫–∏.  
5. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.  
6. –î–æ–±–∞–≤–∏—Ç—å Observability.
7. –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü –ë–î
8. –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –≤ engine
---


